export default class Character{constructor(s,t,i,e,h){this.name=i,this.json=s,this.state=e,this.lastSprites=h,this.sprites=new Map,this.sprites.set("walk",{posX:[],posY:[],sprites:[]}),this.sprites.set("stand",{posX:[],posY:[],sprites:[]}),this.sprites.set("run",{posX:[],posY:[],sprites:[]}),this.sprites.set("fall",{posX:[],posY:[],sprites:[]}),this.sprites.set("jump",{posX:[],posY:[],sprites:[]}),this.sprites.set("win",{posX:[],posY:[],sprites:[]}),this.sprites.set("lose",{posX:[],posY:[],sprites:[]}),this.posX,this.posY,this.move="stand",this.canvas=document.createElement("canvas"),this.canvas.width=this.json.meta.size.w,this.canvas.height=this.json.meta.size.h,this.context=this.canvas.getContext("2d"),this.context.drawImage(t,0,0,this.canvas.width,this.canvas.height)}addSprites(s,t,i,e,h){for(let a=1;a<=t;a++){let t=i;t+=a<10?"_0"+a+".png":"_"+a+".png";let p=this.json.frames[t].frame.x,r=this.json.frames[t].frame.y,o=this.json.frames[t].frame.w,n=this.json.frames[t].frame.h,m=this.context.getImageData(p,r,o,n),l=document.createElement("canvas");l.width=o,l.height=n,l.getContext("2d").putImageData(m,0,0),this.sprites.get(s).sprites.push(l),Array.isArray(h)?this.sprites.get(s).posY.push(h[a-1]):this.sprites.get(s).posY.push(h),Array.isArray(e)?this.sprites.get(s).posX.push(e[a-1]):this.sprites.get(s).posX.push(e)}}walk(){this.move="walk",this.state=this.state>=this.lastSprites.walk-1?0:this.state+1,this.posX+=this.sprites.get(this.move).posX[this.state]}stand(){this.move="stand",this.state=0}run(){this.move="run",this.state=this.state>=this.lastSprites.run-1?0:this.state+1,this.posX+=this.sprites.get(this.move).posX[this.state]}fall(){"jump"!=this.move&&(this.move="fall",this.state=0,this.posY++)}jump(){this.move="jump",this.state=this.state>=this.lastSprites.jump-1?0:this.state+1,this.state==this.lastSprites.jump-1&&(this.posX+=2,this.posY-=5,this.move="stand",this.state=0)}win(){this.move="win","luffy"==this.name?this.state=this.state>=this.lastSprites.win-1?this.lastSprites.win-1:this.state+1:this.state=this.state>=this.lastSprites.win-1?0:this.state+1}lose(){this.move="lose",this.state=0}}