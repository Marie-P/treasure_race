import Map from"./utils/map.js";import GameButtons from"./utils/gameButtons.js";import BackButton from"./utils/backButton.js";import Joystick from"./utils/joystick.js";export default class View{constructor(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.camera1=0,2==t&&(this.canvas2=document.createElement("canvas"),this.context2=this.canvas2.getContext("2d"),this.canvas2.width=window.innerWidth,this.canvas2.height=window.innerHeight/2,this.backgroundWidth2=window.innerWidth,this.backgroundHeight2=window.innerHeight/15,this.camera2=0),this.backButton_x=0,this.backButton_y=0,this.joystick=new Joystick(this.canvas,this.context,200,470,200,470),this.directionalButtonsX=100,this.directionalButtonsY=370,this.directionalButtonsH=10,this.buttons=new GameButtons(this.canvas,this.context,this.directionalButtonsX,this.directionalButtonsY,this.directionalButtonsH,"#000000"),this.backButton=new BackButton(this.canvas,this.context,10,5,55,40)}setView(t){document.body.clientWidth>500?this.canvas.width=window.innerWidth:this.canvas.width=500,this.canvas.height=1==t?window.innerHeight:window.innerHeight/2,this.backgroundWidth=document.body.clientWidth>500?window.innerWidth:500,this.backgroundHeight=window.innerHeight/15}drawMap(t,i,s,a,e){for(let i=0;i<this.backgroundHeight;i++)for(let n=0;n<this.backgroundWidth;n++)s.putImageData(t.map.sprites[a[i*this.backgroundWidth+(n+e)]],n*t.map.tilesWidth,i*t.map.tilesHeight)}drawCharacter(t,i,s){let a=s.posX,e=s.posY+s.sprites.get(s.move).posY[s.state];t.drawImage(s.sprites.get(s.move).sprites[s.state],a*i.map.tilesWidth,e*i.map.tilesWidth)}draw(t){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawMap(t,this.canvas,this.context,t.map.tilemap,this.camera1),this.drawCharacter(this.context,t,t.character1),this.context.fillStyle="#FFFFFF",this.context.fillRect(0,16*(this.backgroundHeight-1),this.canvas.width,this.canvas.height-16*(this.backgroundHeight-1)),1==t.nbPlayers&&(this.joystick.draw(),this.buttons.draw()),2==t.nbPlayers&&(this.context2.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.drawMap(t,this.canvas2,this.context2,t.map.tilemap2,this.camera2),this.drawCharacter(this.context2,t,t.character2)),this.backButton.draw(t)}}